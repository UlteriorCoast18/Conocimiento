\documentclass[12pt]{report}

% --- Paquetes esenciales ---
\usepackage[spanish]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{graphics,graphicx,subfigure}
\usepackage{lipsum,array,multicol,enumerate,enumitem}
\usepackage[framemethod=TikZ]{mdframed}
\usepackage[a4paper, margin=1.5cm]{geometry}
\usepackage{tikz,pgffor,ifthen}
\usepackage{hyperref,longtable,listings}
\usepackage{booktabs}
\usepackage{eso-pic}

% --- Gestión marca de agua --- 
\AddToHook{shipout/foreground}{%
    \begin{tikzpicture}[remember picture,overlay]
        \node at (current page.center){
            \includegraphics[width=\paperwidth,height=\paperheight,keepaspectratio]{watermark-1.png}
        };
    \end{tikzpicture}%
}

% --- Configuración de hipervínculos ---
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=magenta,      
    urlcolor=cyan
}

% --- Estilo para listings (código) ---
\definecolor{listing-background}{HTML}{F7F7F7}
\definecolor{listing-rule}{HTML}{B3B2B3}
\definecolor{listing-numbers}{HTML}{B3B2B3}
\definecolor{listing-text-color}{HTML}{000000}
\definecolor{listing-keyword}{HTML}{435489}
\definecolor{listing-keyword-2}{HTML}{1284CA}
\definecolor{listing-keyword-3}{HTML}{9137CB}
\definecolor{listing-identifier}{HTML}{435489}
\definecolor{listing-string}{HTML}{00999A}
\definecolor{listing-comment}{HTML}{8E8E8E}

\lstdefinestyle{myStyle}{
    language         = C++,
    alsolanguage     = scala,
    numbers          = left,
    xleftmargin      = 2.7em,
    framexleftmargin = 2.5em,
    backgroundcolor  = \color{gray!15},
    basicstyle       = \color{listing-text-color}\linespread{1.0}\ttfamily,
    breaklines       = true,
    frameshape       = {RYR}{Y}{Y}{RYR},
    rulecolor        = \color{black},
    tabsize          = 2,
    numberstyle      = \color{listing-numbers}\linespread{1.0}\small\ttfamily,
    aboveskip        = 1.0em,
    belowskip        = 0.1em,
    abovecaptionskip = 0em,
    belowcaptionskip = 1.0em,
    keywordstyle     = {\color{listing-keyword}\bfseries},
    keywordstyle     = {[2]\color{listing-keyword-2}\bfseries},
    keywordstyle     = {[3]\color{listing-keyword-3}\bfseries\itshape},
    sensitive        = true,
    identifierstyle  = \color{listing-identifier},
    commentstyle     = \color{listing-comment},
    stringstyle      = \color{listing-string},
    showstringspaces = false,
    label            = lst:bar,
    captionpos       = b,
}
\lstset{style = myStyle}

% --- Redefiniciones de encabezados de capítulo y sección ---
\makeatletter
\def\@makechapterhead#1{%
  {\parindent \z@ \raggedright
    \reset@font
    \hrule
    \vspace*{10\p@}%
    \par
    \center \LARGE \scshape \@chapapp{} \huge \thechapter
    \vspace*{10\p@}%
    \par\nobreak
    \vspace*{10\p@}%
    \par
    \vspace*{1\p@}%
    \hrule
    \vspace*{60\p@}
    \Huge #1\par\nobreak
    \vskip 50\p@
  }}
\makeatother

% --- Entornos personalizados ---
\newtheoremstyle{largebreak}{}{ }{\normalfont}{}{\bfseries}{}{\newline}{}
\theoremstyle{largebreak}

\newmdtheoremenv[hidealllines=true,roundcorner=5pt,backgroundcolor=gray!60!red!30]{exa}{Ejemplo}[section]
\newmdtheoremenv[hidealllines=true,roundcorner=5pt,backgroundcolor=gray!50!blue!30]{obs}{Observaci\'on}[section]
\newmdtheoremenv[hidealllines=true,roundcorner=5pt,backgroundcolor=green!50!blue!30]{preg}{Pregunta}[section]
\newmdtheoremenv[hidealllines=true,roundcorner=5pt,backgroundcolor=yellow!40]{idea}{Idea}[section]
\newmdtheoremenv[rightline=false,leftline=false]{theor}{Teorema}[section]
\newmdtheoremenv[rightline=false,leftline=false]{propo}{Proposici\'on}[section]
\newmdtheoremenv[rightline=false,leftline=false]{cor}{Corolario}[section]
\newmdtheoremenv[rightline=false,leftline=false]{lema}{Lema}[section]
\newmdtheoremenv[roundcorner=5pt,backgroundcolor=gray!30,hidealllines=true]{mydef}{Definici\'on}[section]
\newmdtheoremenv[roundcorner=5pt]{excer}{Ejercicio}[section]

% --- Comandos auxiliares ---
\def\proof{\paragraph{Demostraci\'on:\\}}
\def\endproof{\hfill$\blacksquare$}
\def\sol{\paragraph{Soluci\'on:\\}}
\def\endsol{\hfill$\square$}

\newcommand\abs[1]{\ensuremath{\left|#1\right|}}
\newcommand\divides{\ensuremath{\bigm|}}
\newcommand\cf[3]{\ensuremath{#1:#2\rightarrow#3}}
\newcommand\contradiction{\ensuremath{\#_c}}
\newcommand\natint[1]{\ensuremath{\left[\big|#1\big|\right]}}

\newcounter{figcount}
\setcounter{figcount}{1}

\renewcommand{\lstlistingname}{Código}
\renewcommand{\lstlistlistingname}{Lista de \lstlistingname s}

% --- Comienzo del documento ---
\begin{document}

\setlength{\parskip}{5pt}
\setlength{\parindent}{12pt}
\title{T\'itulo o Nombre de las notas}
\author{Cristo Daniel Alvarado}
\maketitle

\tableofcontents

\lstlistoflistings

\newpage

\chapter{Ejemplo}

\section{Ejemplo}

\begin{proof}
    Entorno de Prueba
\end{proof}

\begin{sol}
    Entorno de Soluci\'on
\end{sol}

\begin{theor}[Nombre]
    Teorema
\end{theor}

\begin{propo}[Nombre]
    Proposici\'on
\end{propo}

\begin{cor}[Nombre]
    Corolario
\end{cor}

\begin{lema}[Nombre]
    Lema
\end{lema}

\begin{mydef}[Nombre]
    Definici\'on
\end{mydef}

\begin{obs}[Nombre]
    Observaci\'on
\end{obs}

\begin{exa}[Nombre]
    Ejemplo
\end{exa}

\begin{excer}[Nombre]
    Ejercicio
\end{excer}

\begin{preg}
    Pregunta
\end{preg}

\begin{idea}
    Idea
\end{idea}

\begin{minipage}{\textwidth}
    \begin{center}
        %\includegraphics[scale=0.5]{direccion_imagen}\\
        Figura \thefigcount. Caption.
        \stepcounter{figcount}
    \end{center}
\end{minipage}


\begin{lstlisting}[caption={caption},label=DescriptiveLabel]
    code
\end{lstlisting}

\begin{longtable}{c c}
\toprule
\textbf{ } & \textbf{ } \\
\midrule
\endfirsthead


\midrule
\textbf{ } & \textbf{ } \\
\midrule
\endhead


\bottomrule
\endfoot


 & \\ 
\hline 
 & \\ 
\end{longtable}

\end{document}